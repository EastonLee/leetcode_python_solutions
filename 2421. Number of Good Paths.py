import unittest
from typing import List


# find paths with all nodes' value not greater than val
# edges are undirected, avoid cycles
def findPaths(edges: List[List[int]], values: List[int], start: int, end: int, val: int, path: List[int]) -> List[
    List[int]]:
    if start == end:
        return [[start]]
    paths = []
    path = path + [start]
    for i in range(len(edges)):
        if edges[i][0] == start and edges[i][1] not in path and values[edges[i][1]] <= val:
            paths += [[start] + p for p in findPaths(edges, values, edges[i][1], end, val, path)]
        elif edges[i][1] == start and edges[i][0] not in path and values[edges[i][0]] <= val:
            paths += [[start] + p for p in findPaths(edges, values, edges[i][0], end, val, path)]

    return paths


# find node pairs with same start and end node
def findPairs(values: List[int]) -> List[List[int]]:
    pairs = []
    for i in range(len(values)):
        for j in range(i + 1, len(values)):
            if values[i] == values[j]:
                pairs.append([i, j, values[i]])
    return pairs


class Solution:
    def numberOfGoodPaths(self, vals: List[int], edges: List[List[int]]) -> int:
        pairs = findPairs(vals)
        ans = len(vals)
        print(len(vals))
        for p in pairs:
            paths = findPaths(edges, vals, p[0], p[1], p[2], [])
            ans += len(paths)
        return ans


class Test(unittest.TestCase):
    def test(self):
        cases = [
            [dict(vals=[1, 3, 2, 1, 3], edges=[[0, 1], [0, 2], [2, 3], [2, 4]]), 6],
            [{"vals": [377, 273, 356, 492, 316, 535, 3, 86, 536, 717, 751, 759, 325, 205, 337, 329, 873, 462, 502, 718,
                       612, 725, 582, 375, 787, 402, 54, 889, 715, 84, 751, 944, 215, 233, 800, 144, 721, 441, 700, 557,
                       263, 966, 177, 933, 913, 464, 587, 705, 237, 378, 457, 549, 706, 259, 882, 892, 580, 265, 692,
                       982, 47, 922, 852, 90, 264, 679, 199, 518, 6, 636, 277, 633, 35, 836, 301, 148, 474, 441, 454,
                       762, 753, 883, 699, 625, 577, 447, 905, 934, 600, 69, 819, 208, 510, 199, 74, 406, 583, 65, 981,
                       828, 571, 509, 252, 813, 6, 250, 937, 31, 407, 615, 217, 49, 884, 879, 454, 420, 999, 75, 716,
                       747, 719, 619, 650, 129, 119, 583, 283, 884, 245, 322, 428, 966, 660, 998, 529, 430, 641, 924,
                       374, 314, 91, 6, 152, 532, 31, 47, 14, 267, 893, 312, 593, 569, 516, 598, 614, 310, 941, 219,
                       480, 161, 636, 358, 53, 883, 146, 739, 446, 798, 688, 720, 312, 428, 587, 691, 45, 810, 856, 324,
                       524, 225, 224, 904, 12, 230, 646, 281, 420, 808, 574, 420, 723, 666, 77, 315, 825, 512, 474, 809,
                       877, 420, 931, 983, 745, 171, 602, 227, 435, 424, 870, 584, 958, 97, 653, 374, 2, 655, 56, 275,
                       359, 944, 420, 591, 190, 33, 227, 854, 674, 651, 678, 333, 176, 173, 480, 142, 891, 417, 262,
                       630, 665, 148, 401, 173, 863, 740, 341, 343, 909, 443, 906, 189, 742, 71, 199, 829, 15, 901, 938,
                       890, 970, 886, 382, 314, 759, 985, 845, 950, 933, 748, 770, 857, 160, 264, 987, 768, 64, 853,
                       685, 993, 172, 874, 243, 940, 52, 332, 194, 419, 497, 487, 113, 3, 743, 98, 836, 148, 420, 333,
                       119, 580, 149, 495, 715, 428, 943, 627, 473, 210, 389, 175, 684, 958, 541, 233, 409, 643, 360,
                       69, 682, 470, 194, 110, 141, 196, 730, 386, 173, 837, 917, 15, 408, 459, 498, 513, 795, 518, 887,
                       526, 938, 8, 268, 442, 591, 48, 172, 987, 676, 101, 629, 498, 580, 594, 370, 935, 411, 91, 993,
                       1, 378, 362, 838, 197, 898, 551, 96, 1, 340, 306, 829, 253, 625, 214, 405, 30, 220, 409, 297,
                       313, 819, 342, 742, 326, 282, 594, 933, 101, 878, 557, 211, 284, 928, 904, 921, 164, 820, 818,
                       555, 855, 252, 41, 616, 851, 927, 366, 937, 826, 252, 425, 755, 173, 258, 374, 460, 924, 433,
                       254, 1, 358, 500, 203, 867, 512, 5, 160, 558, 914, 375, 551, 251, 107, 217, 916, 405, 709, 402,
                       154, 319, 939, 93, 130, 486, 545, 771, 193, 241, 237, 691, 512, 296, 780, 710, 776, 942, 669,
                       538, 571, 800, 283, 246, 992, 970, 112, 625, 185, 436, 323, 877, 316, 850, 672, 737, 24, 793,
                       115, 811, 275, 587, 714, 708, 419, 319, 996, 170, 206, 73, 407, 203, 332, 647, 513, 521, 409, 7,
                       235, 208, 647, 947, 94, 355, 263, 791, 204, 220, 492, 28, 725, 656, 44, 809, 984, 956, 274, 220,
                       877, 964, 40, 772, 578, 878, 801, 637, 854, 439, 299, 379, 639, 455, 829, 818, 490, 458, 653,
                       200, 327, 981, 781, 954, 442, 979, 299, 284, 174, 256, 663, 331, 815, 847, 861, 622, 318, 686,
                       560, 516, 236, 857, 839, 973, 721, 691, 815, 898, 505, 712, 908, 881, 811, 823, 745, 283, 981,
                       766, 554, 164, 485, 922, 236, 20, 794, 448, 925, 970, 595, 447, 325, 400, 438, 534, 563, 51, 974,
                       114, 588, 300, 166, 913, 615, 372, 100, 274, 885, 179, 853, 875, 593, 262, 765, 362, 414, 219,
                       899, 41, 949, 923, 288, 825, 663, 728, 397, 471, 89, 121, 180, 511, 444, 140, 773, 625, 180, 944,
                       614, 653, 811, 814, 160, 348, 17, 764, 326, 746, 120, 512, 200, 116, 521, 568, 547, 337, 667,
                       467, 560, 622, 938, 690, 911, 12, 357, 541, 780, 712, 601, 354, 180, 858, 699, 684, 215, 53, 337,
                       449, 928, 867, 180, 830, 776, 720, 359, 376, 990, 384, 990, 553, 832, 103, 34, 218, 726, 629,
                       399, 386, 470, 161, 828, 561, 100, 389],
              "edges": [[0, 1], [0, 2], [0, 3], [1, 4], [5, 4], [4, 6], [4, 7], [3, 8], [9, 3], [10, 0], [0, 11],
                        [8, 12], [1, 13], [14, 2], [15, 5], [16, 9], [17, 10], [18, 12], [19, 13], [7, 20], [10, 21],
                        [1, 22], [23, 0], [19, 24], [16, 25], [26, 18], [27, 2], [8, 28], [29, 7], [9, 30], [31, 24],
                        [32, 21], [14, 33], [34, 14], [35, 31], [31, 36], [27, 37], [38, 21], [8, 39], [10, 40],
                        [19, 41], [42, 19], [8, 43], [44, 4], [8, 45], [46, 15], [11, 47], [48, 10], [49, 14], [50, 13],
                        [49, 51], [2, 52], [25, 53], [54, 2], [15, 55], [50, 56], [57, 11], [9, 58], [59, 24], [60, 59],
                        [61, 36], [62, 50], [12, 63], [64, 35], [65, 33], [22, 66], [48, 67], [68, 34], [69, 2],
                        [70, 19], [71, 64], [72, 69], [73, 60], [4, 74], [36, 75], [76, 67], [77, 0], [78, 53],
                        [79, 77], [40, 80], [5, 81], [26, 82], [83, 16], [52, 84], [85, 34], [38, 86], [80, 87],
                        [85, 88], [66, 89], [90, 34], [51, 91], [24, 92], [93, 85], [63, 94], [70, 95], [48, 96],
                        [97, 37], [98, 7], [99, 98], [92, 100], [101, 25], [73, 102], [103, 41], [20, 104], [105, 82],
                        [106, 6], [82, 107], [108, 93], [28, 109], [110, 104], [111, 74], [112, 62], [112, 113],
                        [23, 114], [115, 85], [116, 32], [117, 106], [21, 118], [119, 112], [74, 120], [110, 121],
                        [82, 122], [123, 113], [20, 124], [125, 68], [74, 126], [105, 127], [51, 128], [129, 1],
                        [0, 130], [36, 131], [132, 53], [133, 77], [134, 26], [83, 135], [136, 52], [6, 137],
                        [138, 123], [14, 139], [19, 140], [60, 141], [40, 142], [82, 143], [144, 122], [54, 145],
                        [52, 146], [7, 147], [23, 148], [135, 149], [150, 80], [112, 151], [124, 152], [120, 153],
                        [22, 154], [101, 155], [156, 96], [134, 157], [54, 158], [20, 159], [30, 160], [149, 161],
                        [68, 162], [32, 163], [32, 164], [165, 146], [166, 93], [22, 167], [168, 96], [169, 125],
                        [170, 138], [171, 73], [65, 172], [147, 173], [42, 174], [175, 111], [122, 176], [177, 152],
                        [152, 178], [149, 179], [180, 33], [31, 181], [182, 86], [113, 183], [184, 144], [62, 185],
                        [24, 186], [1, 187], [188, 57], [189, 31], [190, 125], [191, 82], [192, 106], [164, 193],
                        [194, 41], [59, 195], [189, 196], [197, 148], [198, 172], [199, 33], [200, 61], [201, 39],
                        [103, 202], [203, 67], [204, 121], [205, 48], [106, 206], [207, 202], [208, 183], [22, 209],
                        [210, 35], [211, 56], [212, 83], [161, 213], [214, 158], [215, 32], [216, 45], [96, 217],
                        [218, 106], [53, 219], [220, 84], [221, 165], [38, 222], [35, 223], [90, 224], [225, 56],
                        [26, 226], [101, 227], [228, 147], [229, 220], [148, 230], [165, 231], [232, 118], [233, 180],
                        [148, 234], [235, 102], [236, 130], [237, 164], [26, 238], [112, 239], [106, 240], [241, 100],
                        [242, 118], [201, 243], [122, 244], [4, 245], [12, 246], [116, 247], [248, 225], [249, 219],
                        [250, 67], [251, 175], [252, 100], [149, 253], [14, 254], [255, 77], [256, 160], [257, 80],
                        [31, 258], [259, 106], [182, 260], [261, 134], [214, 262], [72, 263], [264, 65], [117, 265],
                        [266, 231], [267, 151], [268, 60], [269, 213], [270, 127], [271, 33], [272, 32], [66, 273],
                        [274, 146], [275, 23], [262, 276], [277, 233], [266, 278], [247, 279], [280, 58], [281, 132],
                        [282, 74], [283, 24], [140, 284], [285, 282], [286, 213], [287, 278], [214, 288], [233, 289],
                        [290, 119], [223, 291], [279, 292], [293, 149], [200, 294], [143, 295], [296, 134], [73, 297],
                        [90, 298], [299, 237], [300, 147], [301, 188], [138, 302], [303, 16], [304, 102], [21, 305],
                        [40, 306], [307, 3], [308, 139], [214, 309], [254, 310], [162, 311], [312, 124], [313, 112],
                        [78, 314], [315, 282], [316, 219], [317, 74], [286, 318], [319, 204], [320, 319], [321, 72],
                        [42, 322], [162, 323], [324, 80], [189, 325], [112, 326], [327, 235], [82, 328], [81, 329],
                        [17, 330], [331, 34], [304, 332], [85, 333], [118, 334], [335, 107], [102, 336], [228, 337],
                        [338, 112], [339, 88], [340, 309], [61, 341], [342, 50], [229, 343], [344, 35], [91, 345],
                        [346, 51], [127, 347], [22, 348], [306, 349], [350, 151], [351, 175], [21, 352], [353, 87],
                        [37, 354], [321, 355], [93, 356], [357, 215], [358, 111], [359, 81], [360, 337], [361, 237],
                        [271, 362], [152, 363], [340, 364], [365, 178], [204, 366], [299, 367], [368, 219], [369, 247],
                        [370, 304], [371, 330], [372, 13], [68, 373], [374, 289], [98, 375], [376, 109], [226, 377],
                        [378, 164], [372, 379], [317, 380], [381, 143], [298, 382], [7, 383], [365, 384], [211, 385],
                        [63, 386], [387, 132], [388, 85], [240, 389], [276, 390], [380, 391], [187, 392], [331, 393],
                        [394, 54], [395, 353], [34, 396], [397, 146], [398, 167], [289, 399], [400, 164], [216, 401],
                        [402, 391], [333, 403], [404, 332], [77, 405], [406, 260], [14, 407], [216, 408], [409, 264],
                        [410, 169], [249, 411], [351, 412], [93, 413], [145, 414], [415, 298], [1, 416], [182, 417],
                        [392, 418], [148, 419], [420, 220], [421, 92], [323, 422], [358, 423], [424, 317], [425, 306],
                        [426, 413], [427, 59], [25, 428], [429, 378], [430, 177], [284, 431], [432, 23], [433, 273],
                        [368, 434], [435, 223], [127, 436], [437, 409], [272, 438], [439, 391], [440, 173], [401, 441],
                        [332, 442], [397, 443], [444, 285], [322, 445], [446, 8], [447, 130], [173, 448], [449, 345],
                        [450, 57], [451, 396], [452, 30], [64, 453], [308, 454], [455, 394], [456, 309], [139, 457],
                        [458, 66], [332, 459], [460, 53], [461, 90], [462, 56], [188, 463], [456, 464], [410, 465],
                        [28, 466], [287, 467], [468, 356], [422, 469], [6, 470], [74, 471], [472, 458], [473, 303],
                        [474, 62], [475, 64], [114, 476], [477, 163], [347, 478], [153, 479], [480, 115], [39, 481],
                        [482, 286], [483, 68], [228, 484], [485, 108], [486, 389], [189, 487], [488, 354], [489, 76],
                        [490, 256], [491, 112], [492, 121], [493, 286], [494, 251], [495, 75], [496, 492], [497, 72],
                        [498, 497], [499, 242], [500, 123], [501, 460], [427, 502], [503, 470], [339, 504], [505, 309],
                        [8, 506], [507, 183], [162, 508], [254, 509], [223, 510], [354, 511], [512, 293], [513, 248],
                        [511, 514], [515, 391], [157, 516], [268, 517], [518, 405], [434, 519], [520, 164], [521, 388],
                        [290, 522], [88, 523], [524, 110], [269, 525], [526, 333], [8, 527], [100, 528], [307, 529],
                        [530, 147], [531, 133], [112, 532], [533, 361], [389, 534], [535, 396], [484, 536], [99, 537],
                        [538, 255], [457, 539], [110, 540], [541, 483], [541, 542], [224, 543], [544, 130], [545, 332],
                        [546, 357], [367, 547], [548, 266], [119, 549], [550, 164], [551, 402], [261, 552], [57, 553],
                        [127, 554], [555, 280], [526, 556], [557, 225], [558, 29], [98, 559], [383, 560], [83, 561],
                        [562, 261], [563, 253], [564, 553], [56, 565], [22, 566], [107, 567], [568, 504], [304, 569],
                        [570, 371], [571, 528], [572, 516], [573, 337], [574, 70], [139, 575], [442, 576], [384, 577],
                        [578, 84], [579, 510], [580, 32], [581, 248], [582, 482], [583, 21], [105, 584], [157, 585],
                        [418, 586], [587, 308], [234, 588], [218, 589], [68, 590], [141, 591], [454, 592], [593, 110],
                        [55, 594], [293, 595], [596, 63], [437, 597], [598, 381], [599, 137], [186, 600], [5, 601],
                        [602, 599], [150, 603], [604, 152], [605, 85], [606, 319], [607, 65], [196, 608], [172, 609],
                        [331, 610], [495, 611], [197, 612], [613, 440], [614, 583], [359, 615], [616, 168], [617, 566],
                        [618, 306], [149, 619], [620, 174], [621, 252], [622, 582], [623, 50], [407, 624], [625, 244],
                        [626, 546], [627, 13], [628, 432], [629, 241], [630, 433], [631, 584], [420, 632], [500, 633],
                        [634, 562], [43, 635], [473, 636], [637, 518], [638, 282], [46, 639], [29, 640], [218, 641],
                        [642, 256], [643, 406], [568, 644], [432, 645], [646, 633], [647, 422], [370, 648], [169, 649],
                        [650, 492], [467, 651], [50, 652], [653, 14], [582, 654], [572, 655], [656, 263], [142, 657],
                        [480, 658], [659, 411], [176, 660], [661, 478], [662, 391], [407, 663], [664, 584], [665, 575],
                        [366, 666], [667, 175], [582, 668], [304, 669], [387, 670], [477, 671], [672, 241], [52, 673],
                        [252, 674], [227, 675], [676, 152], [667, 677], [328, 678], [326, 679], [462, 680], [0, 681],
                        [45, 682], [683, 670], [627, 684], [685, 398], [686, 585], [92, 687], [688, 335], [146, 689],
                        [448, 690], [213, 691], [490, 692]]}, 0],
        ]
        for ci, co in cases:
            result = Solution().numberOfGoodPaths(ci['vals'], ci['edges'])
            assert result == co, (ci, co, result)


if __name__ == '__main__':
    unittest.main(exit=False)
